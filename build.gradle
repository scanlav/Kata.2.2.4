import java.time.Instant

plugins {
    id 'java'
    id 'application'
}

group = 'com.kata'
version = '1.0-SNAPSHOT'

repositories {
    mavenCentral()
}

application {
    mainClass = 'com.kata.Main'
}
dependencies {
    testImplementation 'org.junit.jupiter:junit-jupiter:5.9.3'
}

tasks.register('archiveReports', Zip) {
    archiveFileName = new Date().format('yyyy-MM-dd-HH:mm:ss-') + "reports" + ".zip"
    destinationDirectory = layout.buildDirectory

    from layout.buildDirectory.dir("reports")
}

tasks.register('cleanReports', Delete) {
    delete fileTree(buildDir).matching {
        include "*-reports.zip"
    }
}

test {
    useJUnitPlatform()
    finalizedBy("archiveReports")
}